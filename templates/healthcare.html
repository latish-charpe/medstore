{% extends 'base.html' %}

{% block title %}Healthcare Products{% endblock %}

{% block content %}
<div class="healthcare-container">
    <!-- Sidebar Navigation -->
    <aside class="healthcare-sidebar">
        <h3 class="sidebar-title"><i class="fas fa-bars"></i> Categories</h3>
        <ul class="category-list">
            {% for category in categories %}
            <li>
                <a href="{{ url_for('healthcare', category=category) }}"
                    class="category-item {% if category == current_category %}active{% endif %}">
                    {{ category }}
                    <i class="fas fa-chevron-right"></i>
                </a>
            </li>
            {% endfor %}
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="healthcare-content">
        <div class="content-header">
            <h1>{{ current_category }}</h1>
            <p>Explore our range of {{ current_category.lower() }} products.</p>
        </div>

        {% if medicines %}
        <div class="medicines-grid">
            {% for med in medicines %}
            <div class="medicine-card">
                <div class="medicine-header">
                    <div style="width: 100%;">
                        <div
                            style="display: flex; justify-content: space-between; margin-bottom: 5px; align-items: flex-start;">
                            <div>
                                <span class="badge badge-success" style="background-color: #e3f2fd; color: #0d47a1;">{{
                                    med.medicine_type }}</span>
                                <span class="badge badge-secondary"
                                    style="background: #f8f9fa; color: #666; font-weight: 500;">{{ med.category.name
                                    }}</span>
                            </div>
                            <div class="expiry-badge">
                                {% if med.expiry_status == 'Expired' %}
                                <span class="badge badge-danger">Expired</span>
                                {% elif med.expiry_status == 'Near Expiry' %}
                                <span class="badge badge-warning">Near Expiry</span>
                                {% endif %}
                            </div>
                        </div>
                        <div class="medicine-name"
                            style="font-size: 1.1rem; min-height: auto; line-height: 1.4; margin-bottom: 5px; font-weight: 600;">
                            {{ med.name }}
                        </div>
                    </div>
                </div>

                <div style="margin: 0 0 15px 0;">
                    <div style="display: flex; justify-content: space-between; align-items: baseline;">
                        <div class="medicine-price">â‚¹{{ med.price }}</div>
                        <span style="font-size: 0.85rem; color: var(--gray);">{{ med.unit }}</span>
                    </div>
                    {% if med.quantity <= 10 and med.quantity> 0 %}
                        <div style="font-size: 0.8rem; color: #e03131; margin-top: 5px;">
                            <i class="fas fa-fire"></i> Only {{ med.quantity }} left!
                        </div>
                        {% endif %}
                </div>

                <div style="margin-top: auto;">
                    {% if med.quantity > 0 %}
                    <form action="{{ url_for('add_to_cart', id=med.id) }}" method="POST"
                        style="display: flex; flex-direction: column; gap: 10px; width: 100%;">
                        <div style="display: flex; gap: 10px;">
                            <select name="quantity" class="form-control"
                                style="padding: 5px; width: 70px; height: 38px;">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="5">5</option>
                            </select>
                            <button type="submit" name="action" value="add_to_cart" class="btn btn-sm btn-secondary"
                                style="flex: 1; border-radius: 6px; font-size: 0.9rem;">Add to Cart</button>
                        </div>
                        <button type="submit" name="action" value="buy_now" class="btn btn-sm btn-primary"
                            style="width: 100%; border-radius: 6px;">Buy Now</button>
                    </form>
                    {% else %}
                    <button class="btn btn-sm btn-danger" style="width: 100%; border-radius: 6px;" disabled>
                        <i class="fas fa-times-circle"></i> Out of Stock
                    </button>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state">
            <i class="fas fa-box-open"></i>
            <h3>No medicines added in this category yet.</h3>
        </div>
        {% endif %}
    </main>
</div>
{% endblock %}